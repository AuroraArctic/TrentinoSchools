library(tidyverse)
df = read.csv("../data/trentino.csv")
df
# Change working directory
getwd()
# Libraries
library(tidyverse)
library(spdep)
library(rgdal)
library(sf)
# Import and try to change CRS
# Read municipality data
tn <- readOGR("../data/Limiti01012021_g/Com01012021_g")
# Filter the province of Trento
tn <- tn[tn$COD_PROV == 22, ]
plot(tn, axes = 1)
plot(tn, axes = 1)
tn <- spTransform(tn, CRS("+init=epsg:4326"))
plot(tn, axes = T)
# 01-Import shapefile as SpatialPointsDataFrame
df <- readOGR("../data/Trentino/schools/schools.shp",
verbose = FALSE
)
df@data["long"] <- df@coords[, 1]
df@data["lat"] <- df@coords[, 2]
df <- spTransform(df, CRS("+init=epsg:4326"))
plot(tn, border = "grey", axes = F)
points(df@coords, col = "cornflowerblue", cex = 1, pch = 1)
knn = c()
for(i in 2:10){
knn <- append(knn,
knn2nb(knearneigh(coordinates(df),
k = i,
longlat = T
)))
}
knn[1]
plot(tn, border = "grey90", axis = tn)
plot(knn[1], df@coords, col = "cornflowerblue", lwd=0.2, cex=0.5, add=TRUE)
df@coords
knn[1]
plot(knn[2], df@coords, col = "cornflowerblue", lwd=0.2, cex=0.5, add=TRUE)
knn[2]
knn2nb(knearneigh(coordinates(df),
k = i,
longlat = T
))
plot(knn2nb(knearneigh(coordinates(df),
k = i,
longlat = T
)), df@coords)
######################################
# Contiguity based approach
contnb_q <- poly2nb(tn, queen=T)
contnb_q
plot(tn, border="grey")
plot(contnb_q, df@coords, add=TRUE)
contnb_q
df@coords
######################################
# Get students data
stud_df = read.csv("../data/schools/students.csv")
stud_df
names(stud_df)
